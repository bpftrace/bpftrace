NAME path
PROG fentry:security_file_open { if (strcontains(path(args.file.f_path, 128), "tmp")) { printf("OK\n"); exit(); } }
EXPECT OK
REQUIRES_FEATURE dpath
AFTER TMPDIR=/tmp ./testprogs/syscall open

NAME no literals
# Clamping is done to not blow verifier complexity limits
PROG tracepoint:syscalls:sys_enter_execve / str(args.argv[0]) == "./testprogs/true" / { print(strcontains(str(args.argv[1], 32), str(args.argv[2], 32))); exit(); }
AFTER ./testprogs/true zztest test
EXPECT true
TIMEOUT 1

NAME string truncation does not affect matching
PROG tracepoint:syscalls:sys_enter_execve / str(args.argv[0]) == "./testprogs/true" / { print(strcontains(str(args.argv[1], 6), str(args.argv[2], 4))); exit(); }
AFTER ./testprogs/true zztest test
EXPECT true

NAME types
PROG BEGIN { strcontains("foo", 1) }
EXPECT_REGEX .* ERROR:.*
WILL_FAIL
